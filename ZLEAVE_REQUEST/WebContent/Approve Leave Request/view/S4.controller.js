/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("hcm.approve.leaverequest.util.CalendarServices");jQuery.sap.require("hcm.approve.leaverequest.util.Conversions");jQuery.sap.require("sap.ca.scfld.md.controller.BaseDetailController");jQuery.sap.require("sap.ca.ui.dialog.factory");sap.ca.scfld.md.controller.BaseDetailController.extend("hcm.approve.leaverequest.view.S4",{extHookChangeFooterButtons:null,onInit:function(){"use strict";this.oView=this.getView();this.resourceBundle=this.oApplicationFacade.getResourceBundle();this.oDataModel=this.oApplicationFacade.getODataModel();this.detailContextPath="";this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="calendar"){var r,R,o,s,a;R=e.getParameter("arguments").RequestId;o=e.getParameter("arguments").SAP__Origin;a="/LeaveRequestSet(RequestId='"+R+"')";this.detailContextPath="LeaveRequestSet(RequestId='"+R+"')";this.oView.bindElement(a);r=new Date();r.setTime(e.getParameter("arguments").StartDate);s=hcm.approve.leaverequest.util.CalendarServices.setDateType(r);hcm.approve.leaverequest.util.CalendarServices.setCalStartDate(s);if(!hcm.approve.leaverequest.util.CalendarServices.getAppModel()){hcm.approve.leaverequest.util.CalendarServices.setAppModel(this.oDataModel);}hcm.approve.leaverequest.util.CalendarServices.clearCalData();jQuery.sap.delayedCall(5,undefined,jQuery.proxy(function(){hcm.approve.leaverequest.util.CalendarServices.readCalData(R,r,null,o);this._onShow(R);},this));}},this);var c=this.byId("OverlapCalendar2"),l=this.byId("CalenderLegend");if(c){c.setModel(hcm.approve.leaverequest.util.CalendarServices.getCalModel());}if(jQuery.device.is.phone){c.setWeeksPerRow(1);}if(l){l.setLegendForNormal(this.resourceBundle.getText("view.Calendar.LegendWorkingDay"));l.setLegendForType00(this.resourceBundle.getText("view.Calendar.LegendDayOff"));l.setLegendForType01(this.resourceBundle.getText("view.Calendar.LegendApproved"));l.setLegendForType04(this.resourceBundle.getText("view.Calendar.LegendPending"));l.setLegendForType06(this.resourceBundle.getText("view.Calendar.LegendHoliday"));l.setLegendForType07(this.resourceBundle.getText("view.Calendar.LegendDeletionRequested"));l.setLegendForToday(this.resourceBundle.getText("view.Calendar.LegendToday"));}},_onShow:function(R){"use strict";var c,p,e;c=this.byId("OverlapCalendar2");if(c){p="/"+R+"/events";e=new sap.me.OverlapCalendarEvent({row:"{Order}",type:"{LegendType}",typeName:"{AbsenceType}",name:"{EmployeeName}"});e.bindProperty("halfDay",{parts:[{path:"AllDayFlag"}],formatter:function(a){var r=false;if(!a){r=true;}return r;}});e.bindProperty("startDay",{parts:[{path:"StartDate"}],formatter:hcm.approve.leaverequest.util.Conversions.convertLocalDateToUTC});e.bindProperty("endDay",{parts:[{path:"EndDate"}],formatter:hcm.approve.leaverequest.util.Conversions.convertLocalDateToUTC});c.bindAggregation("calendarEvents",p,e);c.setStartDate(hcm.approve.leaverequest.util.CalendarServices.getCalStartDate());}},_onChangeDate:function(e){"use strict";var d,p;d=hcm.approve.leaverequest.util.CalendarServices.checkLoadRequired(e.getParameter("firstDate"),e.getParameter("endDate"));if(d.bLoadReq){p=d.bLoadBefore;jQuery.sap.delayedCall(5,undefined,function(){if(hcm.approve.leaverequest.util.CalendarServices.getLeadRequestID()){hcm.approve.leaverequest.util.CalendarServices.readCalData(null,null,p,null);}});}},getHeaderFooterOptions:function(){"use strict";var o={sI18NDetailTitle:"view.Detail.title"};var m=new sap.ui.core.routing.HashChanger();var u=m.getHash();if(u.indexOf("Shell-runStandaloneApp")>=0){o.bSuppressBookmarkButton=true;}if(this.extHookChangeFooterButtons){o=this.extHookChangeFooterButtons(o);}return o;}});
